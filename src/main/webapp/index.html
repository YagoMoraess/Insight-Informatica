<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Insight Informatica</title>
  <style>
    .work-time-container, .work-done-container  {
      margin: 10px;
    }
    .work-time-registers, .work-done-registers {
      margin: 10px;
    }
    .work-time-table, .work-done-table {
      display:flex;
      flex-direction: column;
      margin: 0 20px;
    }
    .input-label {
      margin: 0 10px;
    }
    .send-button {
      margin-top: 10px;
    }
    .work-time-table-item, .work-done-table-item {
      display: flex;
      margin: 10px 0;
    }
    .buttons-container {
      display: flex;
      flex-direction: column;
      width: fit-content;
    }
  </style>
</head>
<body>
  <div class="work-time-container">
    <div>Tabela-Horário De Trabalho</div>
    <div class="work-time-registers">Registros:</div>
    <div class="work-time-table" id="work-time-tables">
      <div class="work-time-table-item" id="work-time-tables-item">
        <label for="work-schedule-start" class="input-label">Entrada:</label>
        <input type="time" id="work-schedule-start0" name="work-schedule-start" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      
        <label for="work-schedule-end" class="input-label">Saída:</label>
        <input type="time" id="work-schedule-end0" name="work-schedule-end" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      </div>
    </div>
  </div>
  <div class="work-done-container">
    <div>Tabela-Marcações Feitas</div>
    <div class="work-done-registers">Registros:</div>
    <div class="work-done-table" id="work-done-tables">
      <div class="work-done-table-item" id="work-done-tables-item">
        <label for="work-schedule-done-start" class="input-label">Entrada:</label>
        <input type="time" id="work-schedule-done-start0" name="work-schedule-done-start" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      
        <label for="work-schedule-done-end" class="input-label">Saída:</label>
        <input type="time" id="work-schedule-done-end0" name="work-schedule-done-end" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      </div>
    </div>
  </div>
  <div class="buttons-container">
    <button class="send-button" onclick="addWorkTimeTable()">Adicionar Campo de Horário de Trabalho</button>
    <button class="send-button" onclick="addWorkTimeDoneTable()">Adicionar Campo de Marcações de Horas Trabalhadas</button>
    <button class="send-button" onclick="sendToServlet()">Enviar</button>

  </div>

  <script>
    var numberOfWorkScheduleRegisters = 1;
    var numberOfWorkDoneRegisters = 1;

    function sendToServlet() {
      var workScheduleStartArray = [];
      var workScheduleEndArray = [];
      var workDoneStartArray = [];
      var workDoneEndArray = [];

      for (var i = 0; i < numberOfWorkScheduleRegisters; i++) {
        var start = document.getElementById('work-schedule-start' + i);
        var end = document.getElementById('work-schedule-end' + i);

        if (start && end) {
          const startObj = {
            id: i,
            type: 'start-work',
            hours: start.value.split(':')[0],
            minutes: start.value.split(':')[1]
          }

          const endObj = {
            id: i,
            type: 'end-work',
            hours: end.value.split(':')[0],
            minutes: end.value.split(':')[1]
          }

          workScheduleStartArray.push(startObj);
          workScheduleEndArray.push(endObj);
        }
      }

      for (var i = 0; i < numberOfWorkDoneRegisters; i++) {
        var start = document.getElementById('work-schedule-done-start' + i);
        var end = document.getElementById('work-schedule-done-end' + i);

        if (start && end) {
          const startObj = {
            id: i,
            type: 'start-done',
            hours: start.value.split(':')[0],
            minutes: start.value.split(':')[1]
          }

          const endObj = {
            id: i,
            type: 'end-done',
            hours: end.value.split(':')[0],
            minutes: end.value.split(':')[1]
          }

          workDoneStartArray.push(startObj);
          workDoneEndArray.push(endObj);
        }
      }

      console.log(workScheduleStartArray, 'work');
      console.log(workScheduleEndArray, 'work');
      console.log(workDoneStartArray, 'done');
      console.log(workDoneEndArray, 'done');

      fetch('http://localhost:8080/Projeto-Insight-Informatica/WorktimeCalculatorServlet', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ workScheduleStartArray: workScheduleStartArray, workScheduleEndArray: workScheduleEndArray,
           workDoneStartArray: workDoneStartArray, workDoneEndArray: workDoneEndArray }),
      })
      .then(response => response.text())
      .then(data => console.log(data))
      .catch((error) => {
        console.error('Error:', error);
      });
    }

    function addWorkTimeTable() {
      var container = document.getElementById('work-time-tables');

      var div = document.createElement('div');
      div.className = 'work-time-table-item';

      var startLabel = document.createElement('label');
      startLabel.className = 'input-label';
      startLabel.textContent = 'Entrada:';
      div.appendChild(startLabel);

      var startInput = document.createElement('input');
      startInput.id = 'work-schedule-start' + numberOfWorkScheduleRegisters;
      startInput.type = 'time';
      startInput.name = 'work-schedule-start';
      startInput.maxLength = '5';
      startInput.pattern = '[0-9]{2}:[0-9]{2}';
      startInput.required = true;
      div.appendChild(startInput);

      var endLabel = document.createElement('label');
      endLabel.className = 'input-label';
      endLabel.textContent = 'Saída:';
      div.appendChild(endLabel);

      var endInput = document.createElement('input');
      endInput.id = 'work-schedule-end' + numberOfWorkScheduleRegisters;
      endInput.type = 'time';
      endInput.name = 'work-schedule-end';
      endInput.maxLength = '5';
      endInput.pattern = '[0-9]{2}:[0-9]{2}';
      endInput.required = true;
      div.appendChild(endInput);

      container.appendChild(div);
      numberOfWorkScheduleRegisters++;
    }

    function addWorkTimeDoneTable() {
      var container = document.getElementById('work-done-tables');

      var div = document.createElement('div');
      div.className = 'work-done-table-item';
	
      var startLabel = document.createElement('label');
      startLabel.className = 'input-label';
      startLabel.textContent = 'Entrada:';
      div.appendChild(startLabel);

      var startInput = document.createElement('input');
      startInput.id = 'work-schedule-done-start' + numberOfWorkDoneRegisters;
      startInput.type = 'time';
      startInput.name = 'work-schedule-done-start';
      startInput.maxLength = '5';
      startInput.pattern = '[0-9]{2}:[0-9]{2}';
      startInput.required = true;
      div.appendChild(startInput);

      var endLabel = document.createElement('label');
      endLabel.className = 'input-label';
      endLabel.textContent = 'Saída:';
      div.appendChild(endLabel);

      var endInput = document.createElement('input');
      endInput.id = 'work-schedule-done-end' + numberOfWorkDoneRegisters;
      endInput.type = 'time';
      endInput.name = 'work-schedule-done-end';
      endInput.maxLength = '5';
      endInput.pattern = '[0-9]{2}:[0-9]{2}';
      endInput.required = true;
      div.appendChild(endInput);

      container.appendChild(div);
      numberOfWorkDoneRegisters++;
    }
  </script>

</body>
</html>