<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Insight Informatica</title>
  <style>
    .work-time-container {
      margin: 10px;
    }
    .work-done-container {
      margin: 10px;
    }
    .work-time-registers {
      margin: 10px;
    }
    .work-time-table {
      display:flex;
      flex-direction: column;
      margin: 0 20px;
    }
    .input-label {
      margin: 0 10px;
    }
    .send-button {
      margin-top: 10px;
    }
    .work-time-table-item {
      display: flex;
      margin: 10px 0;
    }
    .buttons-container {
      display: flex;
      flex-direction: column;
      width: fit-content;
    }
  </style>
</head>
<body>
  <div class="work-time-container">
    <div>Tabela-Horário De Trabalho</div>
    <div class="work-time-registers">Registros:</div>
    <div class="work-time-table" id="work-time-tables">
      <div class="work-time-table-item" id="work-time-tables-item">
        <label for="entrada" class="input-label">Entrada:</label>
        <input type="time" id="entrada0" name="entrada" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      
        <label for="saida" class="input-label">Saída:</label>
        <input type="time" id="saida0" name="saida" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      </div>
    </div>
  </div>
  <div class="work-done-container">
    <div>Tabela-Marcações Feitas</div>
    <div class="work-time-registers">Registros:</div>
    <div class="work-time-table" id="work-time-tables">
      <div class="work-time-table-item" id="work-time-tables-item">
        <label for="entrada" class="input-label">Entrada:</label>
        <input type="time" id="entrada0" name="entrada" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      
        <label for="saida" class="input-label">Saída:</label>
        <input type="time" id="saida0" name="saida" maxlength="5" pattern="[0-9]{2}:[0-9]{2}" required>
      </div>
    </div>
  </div>
  <div class="buttons-container">
    <button class="send-button" onclick="adicionarCampos()">Adicionar Campo de Horário de Trabalho</button>
    <button class="send-button" onclick="adicionarCampos()">Adicionar Campo de Marcações de Horas Trabalhadas</button>
    <button class="send-button" onclick="enviarDadosParaServlet()">Enviar</button>

  </div>

  <script>
    var numberOfRegisters = 1;
    function enviarDadosParaServlet() {
      var entradas = [];
      var saidas = [];

      for (var i = 0; i < numberOfRegisters; i++) {
        var entrada = document.getElementById('entrada' + i);
        var saida = document.getElementById('saida' + i);

        if (entrada && saida) {
          const entradaObj = {
            id: i,
            type: 'entrada',
            hours: entrada.value.split(':')[0],
            minutes: entrada.value.split(':')[1]
          }

          const saidaObj = {
            id: i,
            type: 'saida',
            hours: saida.value.split(':')[0],
            minutes: saida.value.split(':')[1]
          }

          entradas.push(entradaObj);
          saidas.push(saidaObj);
        }
      }

      console.log(entradas)
      console.log(saidas)

      const formData = new FormData();
      formData.append('entradas', JSON.stringify(entradas));
      formData.append('saidas', JSON.stringify(saidas));

      fetch('http://localhost:8080/Projeto-Insight-Informatica/WorktimeCalculatorServlet', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: formData
      })
      .then(response => response.text())
      .then(data => console.log(data))
      .catch((error) => {
        console.error('Error:', error);
      });
    }

    function adicionarCampos() {
      var container = document.getElementById('work-time-tables');

      var div = document.createElement('div');
      div.className = 'work-time-table-item';

      var labelEntrada = document.createElement('label');
      labelEntrada.className = 'input-label';
      labelEntrada.textContent = 'Entrada:';
      div.appendChild(labelEntrada);

      var inputEntrada = document.createElement('input');
      inputEntrada.id = 'entrada' + numberOfRegisters;
      inputEntrada.type = 'time';
      inputEntrada.name = 'entrada';
      inputEntrada.maxLength = '5';
      inputEntrada.pattern = '[0-9]{2}:[0-9]{2}';
      inputEntrada.required = true;
      div.appendChild(inputEntrada);

      var labelSaida = document.createElement('label');
      labelSaida.className = 'input-label';
      labelSaida.textContent = 'Saída:';
      div.appendChild(labelSaida);

      var inputSaida = document.createElement('input');
      inputSaida.id = 'saida' + numberOfRegisters;
      inputSaida.type = 'time';
      inputSaida.name = 'saida';
      inputSaida.maxLength = '5';
      inputSaida.pattern = '[0-9]{2}:[0-9]{2}';
      inputSaida.required = true;
      div.appendChild(inputSaida);

      container.appendChild(div);
      numberOfRegisters++;
    }
  </script>

</body>
</html>